{% extends "base.html" %}

{% block title %}فروشگاه تاسیسات حیدری - صفحه اصلی{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/product.css') }}">
{% endblock %}

{% block content %}


<div class="breadcrumb-wrapper"><div class="container"><nav aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="{{ url_for('index') }}">خانه</a></li><li class="breadcrumb-item"><a href="{{ url_for('products') }}">محصولات</a></li><li class="breadcrumb-item"><a href="#">پکیج دیواری</a></li><li class="breadcrumb-item active">{{ product.product_name }}</li></ol></nav></div></div>
<div class="container"><div class="product-page">
  <div class="product-container">
    <div class="product-gallery">
      {% if product.image_url %}
        <img src="/{{ product.image_url }}" alt="{{ product.product_name }}" class="main-image" id="mainImg">
      {% else %}
        <img src="https://via.placeholder.com/600x480?text=No+Image" alt="{{ product.product_name }}" class="main-image" id="mainImg">
      {% endif %}

      <div class="thumbnails">
        {% for v in variants[:4] %}
          {% if v.product.image_url %}
            <img src="/{{ v.product.image_url }}" alt="{{ product.product_name }}" class="thumb {% if loop.first %}active{% endif %}" onclick="changeImage(this)">
          {% else %}
            <img src="https://via.placeholder.com/90?text=img" alt="thumb" class="thumb {% if loop.first %}active{% endif %}" onclick="changeImage(this)">
          {% endif %}
        {% endfor %}
      </div>
    </div>

    <div class="product-details">
      <h1>{{ product.product_name }}</h1>
      <div class="product-brand">برند: {{ product.brand.brand_name if product.brand }}</div>
      <div class="product-code">کد کالا: {{ product.slug }}</div>

      <div class="price-box">
        <div class="price-wrapper">
          <div>
            <span class="current-price">{{ default_price|currency }}</span>
          </div>
        </div>
      </div>

      <div class="quantity-box">
        <button class="quantity-btn" onclick="changeQty(-1)">−</button>
        <input type="text" value="1" class="quantity-input" id="qty" readonly>
        <button class="quantity-btn" onclick="changeQty(1)">+</button>
      </div>

      <button class="add-to-cart-big">افزودن به سبد خرید</button>

      <ul class="features-list">
        {% for name, val in attributes %}
          <li>{{ name }}: {{ val }}</li>
        {% endfor %}
      </ul>
    </div>
  </div>

  <div class="tabs">
    <div class="tab-links">
      <div class="tab-link active" onclick="openTab('desc')">توضیحات</div>
      <div class="tab-link" onclick="openTab('specs')">مشخصات فنی</div>
      <div class="tab-link" onclick="openTab('reviews')">نظرات کاربران</div>
    </div>
    <div id="desc" class="tab-pane active"><div class="tab-content">{{ product.description|safe }}</div></div>
    <div id="specs" class="tab-pane"><div class="tab-content">
      <table class="specs-table">
        {% for name, val in attributes %}
          <tr><td>{{ name }}</td><td>{{ val }}</td></tr>
        {% endfor %}
      </table>
    </div></div>
    <div id="reviews" class="tab-pane"><div class="tab-content"><p style="color:#999;text-align:center;padding:40px 0">هنوز نظری ثبت نشده است. اولین نفر باشید!</p></div></div>
  </div>

</div>

<div class="related-products">
  <h2>محصولات مرتبط</h2>
  <div class="related-grid">
    {% for r in related %}
      <div class="related-card">
        <div class="related-image">
          {% if r.image_url %}
            <img src="/{{ r.image_url }}" alt="{{ r.product_name }}" style="width:80px;height:80px">
          {% else %}
            <img src="https://via.placeholder.com/80" alt="{{ r.product_name }}">
          {% endif %}
        </div>
        <div class="related-info">
          <h3>{{ r.product_name }}</h3>
          {% set rprice = r.variants[0].retail_price if r.variants|length>0 else None %}
          <div class="related-price">{{ rprice|currency if rprice else '' }}</div>
          <a href="{{ url_for('product_detail', slug=r.slug) }}" class="view-btn">مشاهده محصول</a>
        </div>
      </div>
    {% else %}
      <p class="text-muted">محصول مرتبطی یافت نشد.</p>
    {% endfor %}
  </div>
</div><div class="tabs"><div class="tab-links"><div class="tab-link active" onclick="openTab('desc')">توضیحات</div><div class="tab-link" onclick="openTab('specs')">مشخصات فنی</div><div class="tab-link" onclick="openTab('reviews')">نظرات کاربران</div></div><div id="desc" class="tab-pane active"><div class="tab-content"><p><strong>پکیج دیواری ایران رادیاتور M24FF</strong> یکی از پرفروش‌ترین مدل‌های دو مبدل در ایران است که مناسب آپارتمان‌های تا ۱۵۰ متر مربع می‌باشد.</p><br><p>این پکیج با راندمان بالا، مصرف گاز بهینه و صدای بسیار کم، انتخاب اول بسیاری از مشتریان است. دارای سیستم عیب‌یابی هوشمند و صفحه نمایش دیجیتال برای تنظیم دما و نمایش خطاها.</p><br><p>نصب و راه‌اندازی توسط تیم مجاز ایران رادیاتور انجام می‌شود و شامل خدمات پس از فروش ۲۴ ماهه می‌باشد.</p></div></div><div id="specs" class="tab-pane"><div class="tab-content"><table class="specs-table"><tr><td>ظرفیت حرارتی</td><td>۲۴,۰۰۰ kcal/h</td></tr><tr><td>نوع مبدل</td><td>دو مبدل</td></tr><tr><td>فن دودکش</td><td>دارد (فن‌دار)</td></tr><tr><td>ابعاد</td><td>۷۳۰×۴۰۰×۳۳۰ میلی‌متر</td></tr><tr><td>وزن</td><td>۳۴ کیلوگرم</td></tr><tr><td>گارانتی</td><td>۲۴ ماه ایران رادیاتور</td></tr></table></div></div><div id="reviews" class="tab-pane"><div class="tab-content"><p style="color:#999;text-align:center;padding:40px 0">هنوز نظری ثبت نشده است. اولین نفر باشید!</p></div></div></div></div><div class="related-products"><h2>محصولات مرتبط</h2><div class="related-grid"><div class="related-card"><div class="related-image"><img src="https://cdn-icons-png.flaticon.com/128/2917/2917995.png" alt="پکیج" style="width:80px;height:80px"></div><div class="related-info"><h3>پکیج بوتان مدل CV424</h3><div class="related-price">۳۱,۲۰۰,۰۰۰ تومان</div><button class="view-btn">مشاهده محصول</button></div></div><div class="related-card"><div class="related-image"><img src="https://cdn-icons-png.flaticon.com/128/2062/2062614.png" alt="رادیاتور" style="width:80px;height:80px"></div><div class="related-info"><h3>رادیاتور پنلی لورچ ۱۰۰ سانت</h3><div class="related-price">۲,۸۵۰,۰۰۰ تومان</div><button class="view-btn">مشاهده محصول</button></div></div><div class="related-card"><div class="related-image"><img src="https://cdn-icons-png.flaticon.com/128/2249/2249326.png" alt="شیرآلات" style="width:80px;height:80px"></div><div class="related-info"><h3>شیرآلات قهرمان تنسو کروم</h3><div class="related-price">۸,۹۰۰,۰۰۰ تومان</div><button class="view-btn">مشاهده محصول</button></div></div></div></div></div>



{% block extra_js %}
<script>function changeImage(t){document.getElementById("mainImg").src=t.src,document.querySelectorAll(".thumb").forEach(e=>e.classList.remove("active")),t.classList.add("active")}function changeQty(t){let e=document.getElementById("qty"),a=parseInt(e.value)+t;a<1&&(a=1),e.value=a}function openTab(t){document.querySelectorAll(".tab-pane").forEach(t=>t.classList.remove("active")),document.querySelectorAll(".tab-link").forEach(t=>t.classList.remove("active")),document.getElementById(t).classList.add("active"),event.target.classList.add("active")}</script>
{% endblock %}


{% endblock %}